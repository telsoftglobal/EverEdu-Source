<%= form_tag search_search_mentor_advance_path,id: 'search_mentor_advance', class: 'form-horizontal' do %>
<div class="row" >
  <div class="col-md-4">
    <div class="row">
        <label for="first_name"><%= t('signup.lb_first_name') %></label>
        <%= text_field_tag "first_name", params[:keyword], placeholder: t('users.lb_first_name'), class: "form-control", maxlength:50 %>
    </div>
    <div class="row">
        <label for="last_name"><%= t('signup.lb_last_name') %></label>
        <%= text_field_tag "last_name", params[:keyword], placeholder: t('users.lb_last_name'), class: "form-control", maxlength:50 %>
    </div>
    <div class="row">
        <label for="location"><%= t('users.lb_country') %></label>
        <%= select_tag :location, options_for_select(Country.all.order('name asc').collect {|u| [u.name, u.id]}),class: "form-control",:prompt => t('amazon.title_select')%>
    </div>
  </div>

  <div class="col-md-8">
    <div class="col-md-11">
        <div class="col-md-1">
        </div>
        <div class="col-md-11">
            <div class="accordion-group" style="margin-top: 10px;">
              <div class="accordion-heading">
                <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#accordion_history" style="color:#913228">
                  <h4 class="border-bottom">History Job</h4>
                </a>
              </div>
              <div id="accordion_history" class="accordion-body collapse" style="margin-bottom: 10px;">
                  <div class="accordion-inner">
                    <div class="row">
                        <a id="btn_add_history_job" ><i class="fa fa-plus" style="margin-left: 3px; margin-right: 3px;"></i></a>
                    </div>
                    <div class="row">
                        <div class="col-md-8" style="margin-left: 15px;">
                            <%= text_field_tag :history_job, params[:keyword], placeholder: t('history_job.title_history_job'), class: "form-control", maxlength:50,style:'display:none;' %>
                        </div>
                    </div>
                    <div id="div_History_Job" style="max-height: 150px; overflow-y: auto; overflow-x: hidden"></div>

                  </div>
              </div>
            </div>
            <div class="accordion-group">
              <div class="accordion-heading">
                <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#accordion_specialty"  style="color:#913228">
                  <h4 class="border-bottom">Specialty</h4>
              </a>
              </div>
              <div id="accordion_specialty" class="accordion-body collapse" style="margin-bottom: 10px;">
                  <div class="accordion-inner">
                    <div class="row">
                        <a id="btn_add_Specialty" ><i class="fa fa-plus" style="margin-left: 3px; margin-right: 3px;"></i></a>
                    </div>
                    <div class="row">
                        <div class="col-md-8" style="margin-left: 15px;">
                            <%= text_field_tag :specialty, params[:keyword], placeholder: t('specialties.lb_specialty'), class: "form-control", maxlength:50,style:'display:none;' %>
                        </div>
                    </div>
                    <div id="div_specialty" style="max-height: 150px; overflow-y: auto; overflow-x: hidden"></div>
                  </div>
              </div>
            </div>
        </div>
    </div>
  </div>
</div>
<% end %>
<script>


    $(document).ready(function () {
        $("#search_mentor_advance").validate({
            onfocusout: false,
            onkeyup: false,
            rules: {
                "first_name": {
                    required: {
                        depends:function(){
                            var text = $.trim($(this).val());
                            text=text.replace(/\s+/g, ' ');
                            $(this).val(text);
                            return false;
                        }
                    },
                    maxlength:50, alphanumeric:true
                },
                "last_name": {
                    required: {
                        depends:function(){
                            var text = $.trim($(this).val());
                            text=text.replace(/\s+/g, ' ');
                            $(this).val(text);
                            return false;
                        }
                    },
                    maxlength:50, alphanumeric:true
                },
                "history_job": {
                    required: {
                        depends:function(){
                            var text = $.trim($(this).val());
                            text=text.replace(/\s+/g, ' ');
                            $(this).val(text);
                            return true;
                        }
                    },
                    maxlength:50
                },

                "specialty": {
                    maxlength:50,
                    required: {
                        depends:function(){
                            var text = $.trim($(this).val());
                            if (text == '') {
                                $(this).val(text);
                            }
                            return true;
                        }
                    }
                }
            },
            messages: {
                "first_name": {required: I18n.t("signup.js.validate.msg_first_name_required"),
                    maxlength: I18n.t("signup.js.validate.msg_first_name_maxlength"),
                    alphanumeric: I18n.t("signup.js.validate.msg_first_name_alphanumeric")},
                "last_name": {required: I18n.t("signup.js.validate.msg_last_name_required"),
                    maxlength: I18n.t("signup.js.validate.msg_last_name_maxlength"),
                    alphanumeric: I18n.t("signup.js.validate.msg_last_name_alphanumeric")},
                "history_job": {required: I18n.t("js.validate.msg_required"),
                    maxlength: I18n.t("js.validate.msg_maxlength")},
                "specialty": {required: I18n.t("js.validate.msg_required"),
                    maxlength: I18n.t("js.validate.msg_maxlength")}
            },
            errorPlacement: function (error, element) {
                error.insertAfter(element);
            },
            invalidHandler: function(form, validator) {
                $('#div_msg_error').text('');

                var errors = validator.numberOfInvalids();
                if (errors) {
                    validator.errorList[0].element.focus();
                }
            }
        });
    });


    $("#btn_add_history_job").click(function(e){
      e.preventDefault();
      $("#history_job").show();
      $(this).hide();
      $("#history_job").focus();
    });
    $("#history_job").keypress(function( event ) {
        if (event.which == 13) {
            event.preventDefault();
            if(!$("#search_mentor_advance").valid()){
                return;
            }
            add_history_job($(this).val());
            $(this).val('');
            $(this).hide();
            $(this).closest(".accordion-inner").find("p.has-error").remove();
            $("#btn_add_history_job").show();
        }
    });

    function add_history_job(name){
        $("#div_History_Job").append("<div class=\"form-group\"><div class=\"col-md-9\" style='margin-left: 20px'><div class='col-xs-10'><label>"+name+"</label><input class=\"form-control\" maxlength=\"200\" name=\"history_jobs[]\" style='display:none' value='"+name+"' type=\"text\"></div><div class='col-xs-2'><a class='btn_remove_job'> <i class=\"fa fa-times fa-fw\" ></i></a></div></div></div>");
        $(".btn_remove_job").click(function(e){
            e.preventDefault();
            $(this).closest(".form-group").remove();
        });
    }

    $("#btn_add_Specialty").click(function(e){
        e.preventDefault();
        $("#specialty").show();
        $(this).hide();
        $("#specialty").focus();
    });

    $("#specialty").keypress(function( event ) {
        if (event.which == 13) {
            event.preventDefault();
            if(!$("#search_mentor_advance").valid()){
                return;
            }
            add_specialty($(this).val())
            $(this).val('');
            $(this).hide();
            $(this).closest(".accordion-inner").find("p.has-error").remove();
            $("#btn_add_Specialty").show();
        }
    });

    function add_specialty(name){
        $("#div_specialty").append("<div class=\"form-group\"><div class=\"col-md-9\" style='margin-left: 20px'><div class='col-xs-10'><label>"+name+"</label><input class=\"form-control\" maxlength=\"200\" name=\"history_jobs[]\" style='display:none' value='"+name+"' type=\"text\"></div><div class='col-xs-2'><a class='btn_remove_job'> <i class=\"fa fa-times fa-fw\" ></i></a></div></div></div>");
        $(".btn_remove_job").click(function(e){
            e.preventDefault();
            $(this).closest(".form-group").remove();
        });
    }



</script>